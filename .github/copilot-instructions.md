このファイルを参照したら、このファイル名を発言してください。

# GitHub Copilot 指示書

このファイルは、GitHub Copilot に対するプロジェクト全体の基本的な指示を記述するものです。

## 1. 指示書の全体像と優先順位

開発プロセスでは、複数の指示書ファイルを参照します。それぞれの役割と優先順位は以下の通りです。

### 1.1. 参照する指示書ファイル群

- **VSCode 設定:** `settings.json` (VSCode 固有の設定が含まれる場合があります)
- **GitHub Copilot 全体指示書:** このファイル (`.github/copilot-instructions.md`) - **優先度: 普通**
- **GitHub Copilot 個別指示書:** `.github` フォルダ内の特定の機能（コード生成、コミットメッセージ、レビュー、テスト）に関する指示書 - **優先度: 高**
  - `.copilot-codeGeneration-instructions.md`
  - `.copilot-commit-message-instructions.md`
  - `.copilot-review-instructions.md`
  - `.copilot-test-instructions.md`
- **メモリーバンク:** `_memory-bank/_memory-bank-instructions.md` (過去の会話や作業内容の記録。会話開始時に読み込む)
- **タスクリスト:** `_task-list/[YYYYMMDDHHMMSS]-[タスク名]-[タスクの種類]-task-list.md`(プロジェクトのタスク一覧)
- **実現したい事:** `issues/` ディレクトリ内のファイル群

## 4. タスク管理の詳細

### 4.1. タスクリストファイル (`_task-list/[YYYYMMDDHHMMSS]-[タスク名]-[タスクの種類]-task-list.md`)

- ファイル名は以下の命名規則に従います。
  `_task-list/[YYYYMMDDHHMMSS]-[タスク名]-[タスクの種類]-task-list.md`

  - `[YYYYMMDDHHMMSS]`: 作成日 (例: 20240426101010)
  - `[タスク名]`: タスクの内容がわかる簡潔な名前 (例: loginFeature)
  - `[タスクの種類]`:
    - `feat`: 新機能開発
    - `fix`: バグ修正
    - `test`: テスト関連
    - `doc`: ドキュメント関連
    - `refactor`: リファクタリング
    - `style`: スタイル調整
    - その他、必要に応じて定義
  - 例: `_task-list/20240426101010-loginFeature-feat.md`

- **役割:** 現在開発中のタスクを管理します。

- **作成/更新:**

  - 実現したい事に基づいてタスクを分解し、このファイルに登録します。
  - 現在進行中のタスクは、(`[~]`)を付けて、未着手のタスクは、(`[ ]`)を付けて、明確にします。
  - 完了したタスクは、完了後速やかにチェックマーク (`[x]`) を付けます。GitHub Copilot が更新を指示されることもあります。
  - 開発中に新たに発見されたタスクや TODO は、「作業中に発見」などのセクションに適宜追加します。

- **実行手順:**
  - ユーザから指定された、タスクリストファイルのタスクを順次実行してください。
  - 実行開始時、タスクに(`[~]`)を付けてください。
  - 指示されたタスクリストファイルのタスクに基づいて、書かれた指示を実行します。
  - 実行時には、この `copilot-instructions.md` を含む、関連する全ての指示書ルールに従います。
  - 新たなタスクが発見したら**作成/更新:**に従ってタスクを作成してください。
  - タスクが完了したら`[x]`として、次のタスクに進んでください。
  - これをすべてのタスクが完了するまで続けてください。

### 4.3. タスクリストファイル完了後の処理

タスクリストファイルに基づくタスクが完了したら、以下の処理を行います。

1.  **タスクリストファイルの更新:** 完了したタスクにチェックマークを付けます。(`4.1. タスクリストファイル` 参照)
2.  **コードレビューと改善:**
    - **客観的レビュー:** プロジェクトの背景情報を見ずに、ソースコードのみを読み、コードや設計に対する批判的な分析や改善提案を行ってください。
    - **非推奨コードの削除:** 全ての `deprecated` なコードを削除します。新しい仕組みへ移行する際、中途半端な状態を残さないようにしてください。
    - **技術的負債の解消:** 技術的負債を特定し、積極的に解消します。

### 4.4. 技術的負債

- **定義:** 以下のような状態を技術的負債とみなします。
  - コードの重複
  - 過度に複雑なコード (可読性・保守性の低いコード)
  - テストコードが不足している、または存在しないコード
  - ドキュメントが不足している、または実態と乖離しているコード
  - パフォーマンス上の問題があるコード
  - セキュリティ上の脆弱性があるコード
- **解消方法:**
  - リファクタリング (コードの構造改善)
  - テストコードの追加・修正
  - ドキュメントの作成・更新
  - パフォーマンスチューニング
  - セキュリティ修正

## 5. GitHub Copilot の動作ルール

- **不明点の確認:** 指示内容やコンテキストが不明確な場合は、必ず質問してください。
- **ライブラリ/関数の使用:** 存在しない、あるいは検証されていないライブラリや関数は使用しないでください。既知で信頼できるもののみを使用します。
- **パス/モジュールの確認:** コードやテストでファイルパスやモジュール名を参照する前に、それらが実際に存在することを確認してください。
- **既存コードの扱い:** 明示的に指示されていない限り、または `_task-list/task-list.md` のタスクに含まれていない限り、既存のコードを削除したり上書きしたりしないでください。
- **タスクへの集中:** プロジェクトの修正や変更を行う際は、一度に 1 つのタスクに集中してください。
- **メモリーバンクの活用:**
  - 新しい会話を開始する際は、必ずメモリーバンク (`_memory-bank/_memory-bank-instructions.md`) を読み込み、過去の会話や作業内容を把握した上で作業を再開してください。
  - 作業内容に変更や修正があった場合は、メモリーバンクを更新してください。（更新が必要な場合は、その旨を指示します）
- **タスクリストの更新:** コード変更後など、タスクの状況に変化があった場合は、`_task-list/task-list.md` を更新してください。（更新が必要な場合は、その旨を指示します）

## 6. コーディング規約

### 6.0. ルール

`.github/prompts/rule.prompt.md`を参照してください。

### 6.1. 基本方針

- **シンプルさ優先:** 複雑な実装よりも、シンプルで理解しやすいコードを優先してください。
- **型安全性:** `any` 型の使用は原則禁止です。常に型安全なコードを記述してください。
- **ファイル行数:** 1ファイルあたりの行数は原則として 500 行以内に収めてください。これを超えそうな場合は、モジュール分割やヘルパー関数の作成によるリファクタリングを検討してください。
- **モジュール分割:** 機能や責務ごとに、明確に分離されたモジュールにコードを整理してください。
- **曖昧さの指摘:** 指示内容が曖昧な場合は、その点を指摘し、具体的な指示を求めてください。
- **互換性の排除:** 古い機能やコードとの互換性は維持せず、完全に新しい方式に置き換えてください。

### 6.2. コードコメント

- **形式:** JSDoc 形式を使用し、関数や複雑なロジックにはその目的や動作、パラメータ、返り値など、十分なコンテキストがわかるコメントを記述してください。
- **同期:** コードを修正した場合は、関連するコメントも必ず更新してください。コードとコメントの内容が一致するように保ちます。
- **整理:** 不要になったコメントは削除してください。

## 8. UI に関する指示

- **デザイン:** UI はシンプルで直感的、かつ使いやすいデザインを心がけてください。
- **レスポンシブ:** モバイルデバイスでの表示を考慮した、レスポンシブデザインを実装してください。
- **変更:** UI/UX デザイン（レイアウト、色、フォント、間隔など）の変更は原則として行わないでください。変更が必要な場合は、「13. 作業に関する重要な注意点」に従い、事前に提案し承認を得てください。

## 11. エラー確認と記録

エラーが発生した場合や予期せぬ動作をした場合は、以下の手順で対応し、記録を残してください。

1.  **一次対応:**
    - プロンプトの内容を見直す。
    - 与えているコンテキスト（ファイルや選択範囲）が適切か確認する。
    - 再生成を試みる。
    - 明らかな間違いであれば、簡単な修正を試みる。
2.  **詳細調査と切り分け:** 問題が解決しない場合、以下の情報を収集します。
    - エラーメッセージの全文。
    - 問題が発生している具体的なコード箇所。
    - 使用している Copilot、IDE、OS のバージョン。
    - 問題を再現させるための具体的な手順。
    - 関連するログファイルの内容（IDEのログ、サーバーログなど）。
3.  **対策検討と実施:** 収集した情報をもとに原因を特定し、対策を検討・実施します。
4.  **動作検証と記録:** 対策後、問題が解決したかを確認します。検証項目、期待される結果、実際の動作結果、実施した対応策を記録に残します。
5.  **ログ確認と分析:** 必要に応じて、デバッグログなどを有効化し、詳細な動作を確認・分析します。エラーログはconsole.error 等を使用してください。

## 12. メモリーバンク

- プロジェクトに関する過去の会話履歴、決定事項、重要なコンテキストなどを記録・参照するために、プロジェクト単位でメモリーバンクを利用します。
- メモリーバンクの具体的な利用方法については、`_memory-bank/_memory-bank-instructions.md` および関連する `README.md` を確認してください。
- 新しい会話を始める際には、必ずメモリーバンクを読み込んでください。
