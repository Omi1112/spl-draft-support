# 事前読み込み

- prompt/index.md
- prompt/rule.md
- prompt/dir.md
- prompt/reflection.md

# タスク

## 現在の問題点

GraphQLの検証エラーが発生しています。TournamentParticipantタイプに対して以下のフィールドが定義されていません：

- `id`フィールド
- `tournamentId`フィールド
- `participantId`フィールド

```
{
    "errors": [
        {
            "message": "Cannot query field \"id\" on type \"TournamentParticipant\".",
            "locations": [
                {
                    "line": 4,
                    "column": 9
                }
            ],
            "extensions": {
                "code": "GRAPHQL_VALIDATION_FAILED"
            }
        },
        {
            "message": "Cannot query field \"tournamentId\" on type \"TournamentParticipant\". Did you mean \"Tournament\"?",
            "locations": [
                {
                    "line": 5,
                    "column": 9
                }
            ],
            "extensions": {
                "code": "GRAPHQL_VALIDATION_FAILED"
            }
        },
        {
            "message": "Cannot query field \"participantId\" on type \"TournamentParticipant\". Did you mean \"Participant\"?",
            "locations": [
                {
                    "line": 6,
                    "column": 9
                }
            ],
            "extensions": {
                "code": "GRAPHQL_VALIDATION_FAILED"
            }
        }
    ]
}
```

## TODO リスト

1. GraphQLスキーマファイル(`app/api/graphql/types/`)の確認

   - `TournamentParticipant`タイプの定義を確認
   - 不足しているフィールド(`id`, `tournamentId`, `participantId`)を特定

2. スキーマ定義の修正

   - `TournamentParticipant`タイプに不足しているフィールドを追加
   - 関連リゾルバが必要な場合は確認

3. リゾルバの確認と修正

   - `TournamentParticipant`タイプのリゾルバが適切に実装されているか確認
   - 必要に応じてリゾルバを更新

4. テスト実行
   - 修正後にクエリが正しく動作するか確認

## 実現に必要な情報

### プロジェクト構造（prompt/dir.mdより）

GraphQLに関連するファイルは以下のディレクトリにあります：

```
/workspace/
├── app/
│   ├── api/
│   │   └── graphql/
│   │       ├── resolvers/  # GraphQLリゾルバ
│   │       ├── types/      # GraphQLタイプ定義
│   │       ├── route.ts    # APIルート定義
│   │       └── schema.ts   # GraphQLスキーマ
```

### GraphQL実装の注意点（prompt/reflection.mdより）

1. **スキーマファーストアプローチの徹底**

   - スキーマが「契約」として機能
   - スキーマ定義を先に行い、リゾルバを実装

2. **変更の影響範囲を確認する**

   - GraphQLスキーマ、リゾルバ、アプリケーション層、クライアント側の整合性を確認

3. **作業手順**
   - スキーマ定義 → リゾルバ実装 → ユースケース実装 → クライアント実装の順序で作業

### 関連するデータモデル（prompt/index.mdより）

データベースモデルには以下の関連テーブルがあります：

- トーナメント (Tournament)
- 参加者 (Participant)
- トーナメント参加者関連テーブル (おそらくTournamentParticipant)
- チーム (Team)

### 作業ルール（prompt/rule.mdより）

- 厳格な型チェック（strict type checking）を使用したTypeScriptコードを生成
- null/undefinedの可能性を考慮した安全なコードを書く
- DDDを採用しているため適切に分離する
- リポジトリはEntityと1対1の関係を持ち、Entityが関係するDB以外の参照更新を行わない
