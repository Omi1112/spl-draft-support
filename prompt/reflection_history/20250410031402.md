# 反省点：アプリケーション層での直接的なDBアクセス

## 問題点

`app/api/core/application/useCases/draft/ResetDraftUseCase.ts`にDBアクセスコードが直接書かれてしまいました。これはクリーンアーキテクチャの原則に反しています。

## 具体的な問題

- アプリケーション層のユースケースクラスが直接`PrismaClient`をインポートし使用している
- インフラストラクチャ層の詳細（Prismaの実装詳細）がアプリケーション層に漏れている
- リポジトリパターンを使用していないため、依存性逆転の原則に違反している

## 影響

- テスト容易性の低下（モック化が困難になる）
- コードの結合度が高くなり、将来的な変更が難しくなる
- アーキテクチャ上の責務の分離が不明確になる

## 正しい実装方法

1. ドラフトリセット用のリポジトリインターフェースをドメイン層に定義する
2. そのインターフェースを実装したPrisma用のリポジトリクラスをインフラストラクチャ層に作成する
3. ユースケースクラスはリポジトリインターフェースに依存するように修正する

## 今後の対策

- ユースケースクラスを実装する際は、常にリポジトリインターフェースを通じてデータアクセスを行う
- 直接的なデータベースアクセスコードがアプリケーション層に漏れていないかコードレビューで確認する
- 依存性の方向を常に意識し、内側の層（ドメイン・アプリケーション層）が外側の層（インフラストラクチャ層）に依存しないようにする
